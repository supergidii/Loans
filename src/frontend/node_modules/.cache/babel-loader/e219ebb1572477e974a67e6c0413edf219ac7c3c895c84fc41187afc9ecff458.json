{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/UPFRONT/Documents/newprol/src/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/UPFRONT/Documents/newprol/src/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/web.timers.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport { useStore } from 'vuex';\nexport default {\n  name: 'Referrals',\n  setup: function setup() {\n    var store = useStore();\n    var loading = ref(false);\n    var error = ref(null);\n    var copySuccess = ref(false);\n    var referralLinkInput = ref(null);\n    var referralCode = computed(function () {\n      return store.getters['referrals/referralCode'];\n    });\n    var referrals = computed(function () {\n      return store.getters['referrals/allReferrals'];\n    });\n    var referralStats = computed(function () {\n      return store.getters['referrals/referralStats'];\n    });\n    var referralLink = computed(function () {\n      if (!referralCode.value) return '';\n      return \"\".concat(window.location.origin, \"/register?ref=\").concat(referralCode.value);\n    });\n    var fetchReferrals = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              loading.value = true;\n              error.value = null;\n              _context.prev = 2;\n              _context.next = 5;\n              return store.dispatch('referrals/fetchReferrals');\n            case 5:\n              _context.next = 11;\n              break;\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](2);\n              error.value = 'Failed to load referrals. Please try again later.';\n              console.error('Error fetching referrals:', _context.t0);\n            case 11:\n              _context.prev = 11;\n              loading.value = false;\n              return _context.finish(11);\n            case 14:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[2, 7, 11, 14]]);\n      }));\n      return function fetchReferrals() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var copyReferralLink = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return navigator.clipboard.writeText(referralLink.value);\n            case 3:\n              copySuccess.value = true;\n              setTimeout(function () {\n                copySuccess.value = false;\n              }, 3000);\n              _context2.next = 10;\n              break;\n            case 7:\n              _context2.prev = 7;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.error('Failed to copy link:', _context2.t0);\n            case 10:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[0, 7]]);\n      }));\n      return function copyReferralLink() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var getStatusBadgeClass = function getStatusBadgeClass(status) {\n      var classes = {\n        pending: 'bg-warning',\n        active: 'bg-success',\n        completed: 'bg-info',\n        cancelled: 'bg-danger'\n      };\n      return classes[status] || 'bg-secondary';\n    };\n    onMounted(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            if (referralCode.value) {\n              _context3.next = 9;\n              break;\n            }\n            _context3.prev = 1;\n            _context3.next = 4;\n            return store.dispatch('referrals/generateReferralCode');\n          case 4:\n            _context3.next = 9;\n            break;\n          case 6:\n            _context3.prev = 6;\n            _context3.t0 = _context3[\"catch\"](1);\n            console.error('Error generating referral code:', _context3.t0);\n          case 9:\n            _context3.next = 11;\n            return fetchReferrals();\n          case 11:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3, null, [[1, 6]]);\n    })));\n    return {\n      loading: loading,\n      error: error,\n      referrals: referrals,\n      referralStats: referralStats,\n      referralCode: referralCode,\n      referralLink: referralLink,\n      copySuccess: copySuccess,\n      referralLinkInput: referralLinkInput,\n      copyReferralLink: copyReferralLink,\n      getStatusBadgeClass: getStatusBadgeClass\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","useStore","name","setup","store","loading","error","copySuccess","referralLinkInput","referralCode","getters","referrals","referralStats","referralLink","value","concat","window","location","origin","fetchReferrals","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","dispatch","t0","console","finish","stop","apply","arguments","copyReferralLink","_ref2","_callee2","_callee2$","_context2","navigator","clipboard","writeText","setTimeout","getStatusBadgeClass","status","classes","pending","active","completed","cancelled","_callee3","_callee3$","_context3"],"sources":["C:\\Users\\UPFRONT\\Documents\\newprol\\src\\frontend\\src\\views\\Referrals.vue"],"sourcesContent":["<template>\r\n  <div class=\"referrals\">\r\n    <div class=\"container\">\r\n      <h1 class=\"text-center mb-4\">Your Referrals</h1>\r\n      \r\n      <!-- Referral Link Section -->\r\n      <div class=\"referral-link-section mb-5\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h3>Your Referral Link</h3>\r\n            <p class=\"text-muted\">Share this link with your friends and earn commissions on their investments!</p>\r\n            <div class=\"input-group mb-3\">\r\n              <input \r\n                type=\"text\" \r\n                class=\"form-control\" \r\n                :value=\"referralLink\" \r\n                readonly\r\n                ref=\"referralLinkInput\"\r\n              >\r\n              <button \r\n                class=\"btn btn-primary\" \r\n                @click=\"copyReferralLink\"\r\n                :disabled=\"!referralCode\"\r\n              >\r\n                Copy Link\r\n              </button>\r\n            </div>\r\n            <div class=\"alert alert-success\" v-if=\"copySuccess\" role=\"alert\">\r\n              Link copied to clipboard!\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Referral Stats -->\r\n      <div class=\"referral-stats mb-5\">\r\n        <div class=\"row\">\r\n          <div class=\"col-md-4\">\r\n            <div class=\"card\">\r\n              <div class=\"card-body text-center\">\r\n                <h4>Total Referrals</h4>\r\n                <p class=\"stat-value\">{{ referralStats.totalReferrals }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <div class=\"card\">\r\n              <div class=\"card-body text-center\">\r\n                <h4>Active Referrals</h4>\r\n                <p class=\"stat-value\">{{ referralStats.activeReferrals }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <div class=\"card\">\r\n              <div class=\"card-body text-center\">\r\n                <h4>Total Earnings</h4>\r\n                <p class=\"stat-value\">${{ referralStats.totalEarnings.toFixed(2) }}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- Referrals Table -->\r\n      <div class=\"referrals-table-section\">\r\n        <h2 class=\"mb-4\">Referral History</h2>\r\n        <div v-if=\"loading\" class=\"text-center\">\r\n          <div class=\"spinner-border\" role=\"status\">\r\n            <span class=\"visually-hidden\">Loading...</span>\r\n          </div>\r\n        </div>\r\n        <div v-else-if=\"error\" class=\"alert alert-danger\">\r\n          {{ error }}\r\n        </div>\r\n        <div v-else-if=\"referrals.length === 0\" class=\"alert alert-info\">\r\n          You haven't referred anyone yet. Share your referral link to start earning!\r\n        </div>\r\n        <div v-else class=\"table-responsive\">\r\n          <table class=\"table table-hover\">\r\n            <thead>\r\n              <tr>\r\n                <th>Referred User</th>\r\n                <th>Status</th>\r\n                <th>Commission Rate</th>\r\n                <th>Commission</th>\r\n                <th>Investment Amount</th>\r\n                <th>Date</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              <tr v-for=\"referral in referrals\" :key=\"referral._id\">\r\n                <td>{{ referral.referred.email }}</td>\r\n                <td>\r\n                  <span :class=\"['badge', getStatusBadgeClass(referral.status)]\">\r\n                    {{ referral.status }}\r\n                  </span>\r\n                </td>\r\n                <td>{{ referral.commissionRate }}%</td>\r\n                <td>${{ referral.commission.toFixed(2) }}</td>\r\n                <td>${{ referral.investment ? referral.investment.amount.toFixed(2) : 'N/A' }}</td>\r\n                <td>{{ new Date(referral.createdAt).toLocaleDateString() }}</td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\n\r\nexport default {\r\n  name: 'Referrals',\r\n  setup() {\r\n    const store = useStore()\r\n    const loading = ref(false)\r\n    const error = ref(null)\r\n    const copySuccess = ref(false)\r\n    const referralLinkInput = ref(null)\r\n\r\n    const referralCode = computed(() => store.getters['referrals/referralCode'])\r\n    const referrals = computed(() => store.getters['referrals/allReferrals'])\r\n    const referralStats = computed(() => store.getters['referrals/referralStats'])\r\n    const referralLink = computed(() => {\r\n      if (!referralCode.value) return ''\r\n      return `${window.location.origin}/register?ref=${referralCode.value}`\r\n    })\r\n\r\n    const fetchReferrals = async () => {\r\n      loading.value = true\r\n      error.value = null\r\n      try {\r\n        await store.dispatch('referrals/fetchReferrals')\r\n      } catch (err) {\r\n        error.value = 'Failed to load referrals. Please try again later.'\r\n        console.error('Error fetching referrals:', err)\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n\r\n    const copyReferralLink = async () => {\r\n      try {\r\n        await navigator.clipboard.writeText(referralLink.value)\r\n        copySuccess.value = true\r\n        setTimeout(() => {\r\n          copySuccess.value = false\r\n        }, 3000)\r\n      } catch (err) {\r\n        console.error('Failed to copy link:', err)\r\n      }\r\n    }\r\n\r\n    const getStatusBadgeClass = (status) => {\r\n      const classes = {\r\n        pending: 'bg-warning',\r\n        active: 'bg-success',\r\n        completed: 'bg-info',\r\n        cancelled: 'bg-danger'\r\n      }\r\n      return classes[status] || 'bg-secondary'\r\n    }\r\n\r\n    onMounted(async () => {\r\n      if (!referralCode.value) {\r\n        try {\r\n          await store.dispatch('referrals/generateReferralCode')\r\n        } catch (err) {\r\n          console.error('Error generating referral code:', err)\r\n        }\r\n      }\r\n      await fetchReferrals()\r\n    })\r\n\r\n    return {\r\n      loading,\r\n      error,\r\n      referrals,\r\n      referralStats,\r\n      referralCode,\r\n      referralLink,\r\n      copySuccess,\r\n      referralLinkInput,\r\n      copyReferralLink,\r\n      getStatusBadgeClass\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.referrals {\r\n  padding: 20px 0;\r\n}\r\n\r\n.referral-link-section {\r\n  background-color: #f8f9fa;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n}\r\n\r\n.card {\r\n  border: none;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.stat-value {\r\n  font-size: 24px;\r\n  font-weight: bold;\r\n  color: #2c3e50;\r\n  margin: 10px 0;\r\n}\r\n\r\n.table {\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n}\r\n\r\n.badge {\r\n  padding: 8px 12px;\r\n  font-weight: 500;\r\n}\r\n\r\n.alert {\r\n  margin-top: 10px;\r\n}\r\n\r\n.input-group {\r\n  max-width: 600px;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}